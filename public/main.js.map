{"version":3,"sources":["../app/client/audio.js","../app/client/constants.js","../app/client/notes.js","../app/client/Piano.js","../app/client/RefManager.js","../app/client/SmartArray.js","../app/client/start.js"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["(function() {\r\n  class Audio {\r\n    constructor() {\r\n      this.pitchSamples = new SP_APP.SmartArray();\r\n    }\r\n\r\n    drawPitchMarkers(canvas2Context) {\r\n      canvas2Context.fillStyle = 'firebrick';\r\n      canvas2Context.font = '14px serif';\r\n      for (let i = 25; i < 1200; i += 25) {\r\n        const pos = i / 2;\r\n        canvas2Context.fillRect(65, pos, 4, 1);\r\n        canvas2Context.fillText(i.toString(), 70, pos + 5);\r\n      }\r\n    }\r\n\r\n    start() {\r\n      const {refs, KEYS} = SP_APP;\r\n      let audioReady = false;\r\n      let loudEnough = false;\r\n      const MIN_VOLUME = 5;\r\n\r\n      const ref = document.location.pathname.replace(/^\\//, '');\r\n\r\n      const audioContext = new window.AudioContext();\r\n      let audioEl = refs[ref] || document.querySelector('audio');\r\n      const analyser = audioContext.createAnalyser();\r\n\r\n      const {sampleRate} = audioContext;\r\n\r\n      analyser.fftSize = 2048;\r\n      analyser.minDecibels = -90;\r\n      analyser.maxDecibels = -10;\r\n      const bufferLength = analyser.frequencyBinCount;\r\n      const dataArray = new Uint8Array(bufferLength);\r\n\r\n      const canvasContext = refs.canvas.getContext('2d');\r\n      // const canvas2Context = refs.canvas2.getContext('2d');\r\n      // this.drawPitchMarkers(canvas2Context);\r\n\r\n      const userMediaConstraints = {audio: true};\r\n\r\n      const getUserMediaSuccess = stream => {\r\n        const audioSource = audioContext.createMediaStreamSource(stream);\r\n        refs.mic_audio.src = audioSource;\r\n\r\n        audioSource.connect(analyser);\r\n        // comment/uncomment to play to speakers\r\n        // audioSource.connect(audioContext.destination); // out to the speakers\r\n        audioReady = true;\r\n      };\r\n\r\n      const getUserMediaError = err => {\r\n        err && console.error(err);\r\n      };\r\n\r\n      navigator.getUserMedia(userMediaConstraints, getUserMediaSuccess, getUserMediaError);\r\n\r\n      // canvas2Context.fillStyle = 'rgba(0, 0, 0, 0.03)';\r\n\r\n      let lastItem = 0;\r\n      const STEPS_THRESHOLD = 5;\r\n\r\n      const getKey = () => {\r\n        const pitch = this.pitchSamples.mode;\r\n        let closestLower = KEYS[0];\r\n        let closestHigher = KEYS[KEYS.length - 1];\r\n\r\n        for (let i = 0; i < KEYS.length; i++) {\r\n          if (KEYS[i].hz < pitch) closestLower = KEYS[i];\r\n          if (KEYS[i].hz > pitch) {\r\n            closestHigher = KEYS[i];\r\n            break; // going from low to high so we can stop here\r\n          }\r\n        }\r\n\r\n        const distanceToLower = Math.abs(pitch - closestLower.hz);\r\n        const distanceToHigher = Math.abs(pitch - closestHigher.hz);\r\n\r\n        return Math.min(distanceToLower, distanceToHigher) === distanceToLower\r\n          ? closestLower\r\n          : closestHigher;\r\n      };\r\n\r\n      const renderKey = () => {\r\n        const key = getKey();\r\n        // refs.note.textContent = `That was note number ${key.pos}: ${key.name}`;\r\n\r\n        // TODO (davidg): push this out into the Piano class\r\n        const keyEls = document.querySelectorAll('[piano-key]');\r\n\r\n        for (let keyEl of keyEls) {\r\n          keyEl.style.fill = '';\r\n          keyEl.classList.remove('piano-key--lit');\r\n        }\r\n\r\n        const pressedKeyEl = SP_APP.refs[`key_${key.pos}`];\r\n        pressedKeyEl.classList.add('piano-key--lit');\r\n        // if (keyEl) keyEl.style.fill = '#2196f3';\r\n        this.pitchSamples.empty();\r\n      };\r\n\r\n      const drawWave = () => {\r\n        if (!loudEnough) return;\r\n        canvasContext.fillStyle = 'firebrick';\r\n        analyser.getByteTimeDomainData(dataArray);\r\n        canvasContext.fillRect(0, 128, 1024, 2);\r\n\r\n        let lastPos = 0;\r\n        dataArray.forEach((item, i) => {\r\n          if (i > 0 && i < dataArray.length && item > 128 && lastItem <= 128) {\r\n            const elapsedSteps = i - lastPos;\r\n            lastPos = i;\r\n\r\n            if (elapsedSteps > STEPS_THRESHOLD) {\r\n              const hertz = 1 / (elapsedSteps / sampleRate); // sampleRate = 44100\r\n              this.pitchSamples.push(hertz);\r\n              // canvas2Context.fillRect(4, hertz / 2, 65, 1); // pitch marker\r\n            }\r\n          }\r\n\r\n          canvasContext.fillRect(i, item, 2, 2); // point in the wave\r\n\r\n          lastItem = item;\r\n        });\r\n      };\r\n\r\n      const drawFreq = () => {\r\n        canvasContext.fillStyle = 'lightgray';\r\n        analyser.getByteFrequencyData(dataArray);\r\n        let volumeTotal = 0;\r\n        canvasContext.fillRect(0, (300 - (256 / 10)), 1024, 1);\r\n\r\n        dataArray.forEach((item, i) => {\r\n          canvasContext.fillRect(i, 300 - item, 1, item);\r\n          volumeTotal += item;\r\n        });\r\n\r\n        const volume = volumeTotal / dataArray.length;\r\n        const nowLoudEnough = volume > MIN_VOLUME;\r\n\r\n        if (loudEnough !== nowLoudEnough) {\r\n          this.pitchSamples.empty();\r\n        }\r\n\r\n        loudEnough = nowLoudEnough;\r\n        refs.db.textContent = volume;\r\n      };\r\n\r\n      const renderAudio = () => {\r\n        requestAnimationFrame(renderAudio);\r\n\r\n        if (!audioReady) return;\r\n\r\n        canvasContext.clearRect(0, 0, 1024, 300);\r\n\r\n        drawFreq();\r\n        drawWave();\r\n      };\r\n\r\n      renderAudio();\r\n\r\n      setInterval(() => {\r\n        loudEnough && renderKey();\r\n      }, 250);\r\n\r\n      window.addEventListener('keydown', e => {\r\n        if (e.keyCode === 32) { // space\r\n          audioEl.paused ? audioEl.play() : audioEl.pause();\r\n        }\r\n      });\r\n\r\n      audioEl.play();\r\n    }\r\n  }\r\n\r\n  SP_APP.Audio = Audio;\r\n})();\r\n","\r\nSP_APP.KEYS = [\r\n  {pos: 1, hz: 27.5, name: 'A0 Double Pedal A'},\r\n  {pos: 2, hz: 29.1352, name: 'A♯0/B♭0'},\r\n  {pos: 3, hz: 30.8677, name: 'B0'},\r\n  {pos: 4, hz: 32.7032, name: 'C1 Pedal C'},\r\n  {pos: 5, hz: 34.6478, name: 'C♯1/D♭1'},\r\n  {pos: 6, hz: 36.7081, name: 'D1'},\r\n  {pos: 7, hz: 38.8909, name: 'D♯1/E♭1'},\r\n  {pos: 8, hz: 41.2034, name: 'E1'},\r\n  {pos: 9, hz: 43.6535, name: 'F1'},\r\n  {pos: 10, hz: 46.2493, name: 'F♯1/G♭1'},\r\n  {pos: 11, hz: 48.9994, name: 'G1'},\r\n  {pos: 12, hz: 51.9131, name: 'G♯1/A♭1'},\r\n  {pos: 13, hz: 55, name: 'A1'},\r\n  {pos: 14, hz: 58.2705, name: 'A♯1/B♭1'},\r\n  {pos: 15, hz: 61.7354, name: 'B1'},\r\n  {pos: 16, hz: 65.4064, name: 'C2 Deep C'},\r\n  {pos: 17, hz: 69.2957, name: 'C♯2/D♭2'},\r\n  {pos: 18, hz: 73.4162, name: 'D2'},\r\n  {pos: 19, hz: 77.7817, name: 'D♯2/E♭2'},\r\n  {pos: 20, hz: 82.4069, name: 'E2'},\r\n  {pos: 21, hz: 87.3071, name: 'F2'},\r\n  {pos: 22, hz: 92.4986, name: 'F♯2/G♭2'},\r\n  {pos: 23, hz: 97.9989, name: 'G2'},\r\n  {pos: 24, hz: 103.826, name: 'G♯2/A♭2'},\r\n  {pos: 25, hz: 110, name: 'A2'},\r\n  {pos: 26, hz: 116.541, name: 'A♯2/B♭2'},\r\n  {pos: 27, hz: 123.471, name: 'B2'},\r\n  {pos: 28, hz: 130.813, name: 'C3'},\r\n  {pos: 29, hz: 138.591, name: 'C♯3/D♭3'},\r\n  {pos: 30, hz: 146.832, name: 'D3'},\r\n  {pos: 31, hz: 155.563, name: 'D♯3/E♭3'},\r\n  {pos: 32, hz: 164.814, name: 'E3'},\r\n  {pos: 33, hz: 174.614, name: 'F3'},\r\n  {pos: 34, hz: 184.997, name: 'F♯3/G♭3'},\r\n  {pos: 35, hz: 195.998, name: 'G3'},\r\n  {pos: 36, hz: 207.652, name: 'G♯3/A♭3'},\r\n  {pos: 37, hz: 220, name: 'A3'},\r\n  {pos: 38, hz: 233.082, name: 'A♯3/B♭3'},\r\n  {pos: 39, hz: 246.942, name: 'B3'},\r\n  {pos: 40, hz: 261.626, name: 'C4 Middle C'},\r\n  {pos: 41, hz: 277.183, name: 'C♯4/D♭4'},\r\n  {pos: 42, hz: 293.665, name: 'D4'},\r\n  {pos: 43, hz: 311.127, name: 'D♯4/E♭4'},\r\n  {pos: 44, hz: 329.628, name: 'E4'},\r\n  {pos: 45, hz: 349.228, name: 'F4'},\r\n  {pos: 46, hz: 369.994, name: 'F♯4/G♭4'},\r\n  {pos: 47, hz: 391.995, name: 'G4'},\r\n  {pos: 48, hz: 415.305, name: 'G♯4/A♭4'},\r\n  {pos: 49, hz: 440, name: 'A4 A440'},\r\n  {pos: 50, hz: 466.164, name: 'A♯4/B♭4'},\r\n  {pos: 51, hz: 493.883, name: 'B4'},\r\n  {pos: 52, hz: 523.251, name: 'C5 Tenor C'},\r\n  {pos: 53, hz: 554.365, name: 'C♯5/D♭5'},\r\n  {pos: 54, hz: 587.33, name: 'D5'},\r\n  {pos: 55, hz: 622.254, name: 'D♯5/E♭5'},\r\n  {pos: 56, hz: 659.255, name: 'E5'},\r\n  {pos: 57, hz: 698.456, name: 'F5'},\r\n  {pos: 58, hz: 739.989, name: 'F♯5/G♭5'},\r\n  {pos: 59, hz: 783.991, name: 'G5'},\r\n  {pos: 60, hz: 830.609, name: 'G♯5/A♭5'},\r\n  {pos: 61, hz: 880, name: 'A5'},\r\n  {pos: 62, hz: 932.328, name: 'A♯5/B♭5'},\r\n  {pos: 63, hz: 987.767, name: 'B5'},\r\n  {pos: 64, hz: 1046.5, name: 'C6 Soprano C(High C)'},\r\n  {pos: 65, hz: 1108.73, name: 'C♯6/D♭6'},\r\n  {pos: 66, hz: 1174.66, name: 'D6'},\r\n  {pos: 67, hz: 1244.51, name: 'D♯6/E♭6'},\r\n  {pos: 68, hz: 1318.51, name: 'E6'},\r\n  {pos: 69, hz: 1396.91, name: 'F6'},\r\n  {pos: 70, hz: 1479.98, name: 'F♯6/G♭6'},\r\n  {pos: 71, hz: 1567.98, name: 'G6'},\r\n  {pos: 72, hz: 1661.22, name: 'G♯6/A♭6'},\r\n  {pos: 73, hz: 1760, name: 'A6'},\r\n  {pos: 74, hz: 1864.66, name: 'A♯6/B♭6'},\r\n  {pos: 75, hz: 1975.53, name: 'B6'},\r\n  {pos: 76, hz: 2093, name: 'C7 Double high C'},\r\n  {pos: 77, hz: 2217.46, name: 'C♯7/D♭7'},\r\n  {pos: 78, hz: 2349.32, name: 'D7'},\r\n  {pos: 79, hz: 2489.02, name: 'D♯7/E♭7'},\r\n  {pos: 80, hz: 2637.02, name: 'E7'},\r\n  {pos: 81, hz: 2793.83, name: 'F7'},\r\n  {pos: 82, hz: 2959.96, name: 'F♯7/G♭7'},\r\n  {pos: 83, hz: 3135.96, name: 'G7'},\r\n  {pos: 84, hz: 3322.44, name: 'G♯7/A♭7'},\r\n  {pos: 85, hz: 3520, name: 'A7'},\r\n  {pos: 86, hz: 3729.31, name: 'A♯7/B♭7'},\r\n  {pos: 87, hz: 3951.07, name: 'B7'},\r\n  {pos: 88, hz: 4186.01, name: 'C8 Eighth octave'},\r\n];\r\n","SP_APP.printNotes = () => {\r\n  const notes = ['a', 'b', 'c'];\r\n\r\n  notes.forEach(note => {\r\n    console.log('note');\r\n  });\r\n};\r\n","(function() {\r\n  const COLORS = {\r\n    EBONY: 'ebony',\r\n    IVORY: 'ivory',\r\n  };\r\n  const SHIFTS = {\r\n    LEFT: 'LEFT',\r\n    MIDDLE: 'MIDDLE',\r\n    RIGHT: 'RIGHT',\r\n  };\r\n\r\n  function getKeyDeets(keyPos) {\r\n    const key = keyPos % 12;\r\n    let shift;\r\n    let color;\r\n\r\n    if (key === 2 || key === 7) {\r\n      shift = SHIFTS.RIGHT;\r\n      color = COLORS.EBONY;\r\n    } else if (key === 5 || key === 10) {\r\n      shift = SHIFTS.LEFT;\r\n      color = COLORS.EBONY;\r\n    } else if (key === 0) {\r\n      shift = SHIFTS.MIDDLE;\r\n      color = COLORS.EBONY;\r\n    } else {\r\n      shift = null;\r\n      color = COLORS.IVORY;\r\n    }\r\n    return {shift, color};\r\n  }\r\n\r\n  class Piano {\r\n    render() {\r\n      // key dimensions from http://www.rwgiangiulio.com/construction/manual/\r\n      const {KEYS, refs} = SP_APP;\r\n      const pianoEl = refs.piano;\r\n      const ns = 'http://www.w3.org/2000/svg';\r\n\r\n      let left = 0;\r\n      const blackKeyGroup = document.createElementNS(ns, 'g');\r\n      const whiteKeyGroup = document.createElementNS(ns, 'g');\r\n\r\n      KEYS.forEach(key => {\r\n        const keyRect = document.createElementNS(ns, 'rect');\r\n        const keyDeets = getKeyDeets(key.pos);\r\n        let x = left;\r\n        let height = 125;\r\n        let width = 22;\r\n\r\n        if (keyDeets.color === COLORS.EBONY) {\r\n          height -= 45;\r\n          width = 11;\r\n\r\n          if (keyDeets.shift === SHIFTS.LEFT) {\r\n            x = left - 7;\r\n          } else if (keyDeets.shift === SHIFTS.MIDDLE) {\r\n            x = left - 5;\r\n          } else if (keyDeets.shift === SHIFTS.RIGHT) {\r\n            x = left - 3;\r\n          } else {\r\n            console.warn('SHIFT was not set');\r\n          }\r\n        } else {\r\n          left += 22;\r\n          const keyText = document.createElementNS(ns, 'text');\r\n          keyText.textContent = key.pos;\r\n\r\n          keyText.setAttribute('x', x + width / 2);\r\n          keyText.setAttribute('y', 10);\r\n          keyText.setAttribute('text-anchor', 'middle');\r\n          whiteKeyGroup.appendChild(keyText);\r\n        }\r\n\r\n        keyRect.setAttribute('rx', 2);\r\n        keyRect.setAttribute('x', x);\r\n        keyRect.setAttribute('y', 14);\r\n        keyRect.setAttribute('width', width);\r\n        keyRect.setAttribute('height', height);\r\n        keyRect.setAttribute('data-ref', `key_${key.pos}`);\r\n        keyRect.setAttribute('piano-key', true);\r\n        keyRect.classList.add('piano-key');\r\n        keyRect.classList.add(`piano-key--${keyDeets.color}`);\r\n\r\n        if (keyDeets.color === COLORS.EBONY) {\r\n          blackKeyGroup.appendChild(keyRect);\r\n        } else {\r\n          whiteKeyGroup.appendChild(keyRect);\r\n        }\r\n      });\r\n\r\n      pianoEl.appendChild(whiteKeyGroup);\r\n      pianoEl.appendChild(blackKeyGroup);\r\n    }\r\n  }\r\n\r\n  SP_APP.Piano = Piano;\r\n})();\r\n","(function() {\r\n  class RefManager {\r\n    getRefs() {\r\n      const refEls = document.querySelectorAll('[data-ref]');\r\n      SP_APP.refs = {};\r\n      for (let refEl of refEls) {\r\n        const ref = refEl.getAttribute('data-ref'); // dataset doesn't work on <svg>\r\n        SP_APP.refs[ref] = refEl;\r\n      }\r\n    }\r\n  }\r\n\r\n  SP_APP.RefManager = RefManager;\r\n})();\r\n","(function() {\r\n\r\n  class SmartArray {\r\n    constructor() {\r\n      this.dataArray = [];\r\n    }\r\n\r\n    push(item) {\r\n      this.dataArray.push(item);\r\n    }\r\n\r\n    get avg() {\r\n      return this.dataArray.reduce((result, time) => {\r\n          return result + time;\r\n        }, 0) / this.dataArray.length;\r\n    }\r\n\r\n    get median() {\r\n      if (!this.dataArray.length) return 0;\r\n      const midPoint = Math.floor(this.dataArray.length / 2);\r\n      return this.dataArray[midPoint];\r\n    }\r\n\r\n    get mode() {\r\n      if (!this.dataArray.length) return 0;\r\n\r\n      const counts = {};\r\n      let mode = null;\r\n      let max = 0;\r\n\r\n      this.dataArray.forEach(item => {\r\n        const value = Math.round(item * 10) / 10;\r\n\r\n        counts[value] = (counts[value] || 0) + 1;\r\n\r\n        if (counts[value] > max) {\r\n          max = counts[value];\r\n          mode = value;\r\n        }\r\n      });\r\n\r\n      return mode;\r\n    }\r\n\r\n    empty() {\r\n      this.dataArray.length = 0;\r\n    }\r\n  }\r\n\r\n  SP_APP.SmartArray = SmartArray;\r\n})();\r\n","SP_APP.start = () => {\r\n  const {Audio, Piano} = SP_APP;\r\n\r\n  // build refs object\r\n  const refEls = document.querySelectorAll('[data-ref]');\r\n  SP_APP.refs = {};\r\n  for (let refEl of refEls) {\r\n    const ref = refEl.getAttribute('data-ref'); // dataset doesn't work on <svg>\r\n    SP_APP.refs[ref] = refEl;\r\n  }\r\n\r\n\r\n  const piano = new Piano();\r\n  piano.render();\r\n\r\n  // build the refs after rendering the piano\r\n  SP_APP.refManager = new SP_APP.RefManager();\r\n  SP_APP.refManager.getRefs();\r\n\r\n  const audio = new Audio();\r\n  audio.start();\r\n};\r\n"]}